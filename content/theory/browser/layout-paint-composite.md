# Layout / Paint / Composite ‚Äî reflow –∏ repaint

## –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ

–≠—Ç–∞ —Ç–µ–º–∞ ‚Äî –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–µ–Ω–¥–µ—Ä-–ø–∞–π–ø–ª–∞–π–Ω–∞ –∏ –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö **–ª—é–±–∏–º—ã—Ö –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è—Ö**.
–û–Ω–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:
- –ø–æ—á–µ–º—É UI –ª–∞–≥–∞–µ—Ç
- –∫–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∞–º—ã–µ –¥–æ—Ä–æ–≥–∏–µ
- –∫–∞–∫ –ø–∏—Å–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π CSS –∏ JS
- –ø–æ—á–µ–º—É –æ–¥–Ω–∏ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–ª–∞–≤–Ω—ã–µ, –∞ –¥—Ä—É–≥–∏–µ –Ω–µ—Ç

---

## –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è

–ù–µ –∫–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ DOM –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ–ª–Ω–æ–º—É –ø–µ—Ä–µ—Ä–∞—Å—á—ë—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

–ò–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–≥—É—Ç –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—Ç—å:
- **Layout (reflow)** ‚Äî —Å–∞–º—ã–π –¥–æ—Ä–æ–≥–æ–π —ç—Ç–∞–ø
- **Paint (repaint)** ‚Äî —Å—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
- **Composite** ‚Äî —Å–∞–º—ã–π –¥–µ—à—ë–≤—ã–π

> –ß–µ–º –º–µ–Ω—å—à–µ —ç—Ç–∞–ø–æ–≤ –∑–∞—Ç—Ä–æ–Ω—É—Ç–æ ‚Äî —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ —Ä–∞–±–æ—Ç–∞–µ—Ç UI.

---

## Layout (Reflow)

### –ß—Ç–æ —ç—Ç–æ

Layout ‚Äî —ç—Ç–æ —ç—Ç–∞–ø, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—Ä–∞—É–∑–µ—Ä:
- –≤—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏—Ö –ø–æ–∑–∏—Ü–∏—é –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

–õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ, –≤–ª–∏—è—é—â–µ–µ –Ω–∞ –≥–µ–æ–º–µ—Ç—Ä–∏—é, –≤—ã–∑—ã–≤–∞–µ—Ç layout.

### –¢—Ä–∏–≥–≥–µ—Ä—ã layout

- width / height
- margin / padding
- font-size
- display
- –∏–∑–º–µ–Ω–µ–Ω–∏–µ DOM-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- —á—Ç–µ–Ω–∏–µ layout-—Å–≤–æ–π—Å—Ç–≤ –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏

```js
el.style.width = "200px";
const w = el.offsetWidth; // üí• layout
```

‚ùó Layout –º–æ–∂–µ—Ç –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—Ç—å **–≤—Å—ë –¥–µ—Ä–µ–≤–æ**.

---

## Paint (Repaint)

### –ß—Ç–æ —ç—Ç–æ

Paint ‚Äî —ç—Ç–æ –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –ø–∏–∫—Å–µ–ª–µ–π:
- —Ü–≤–µ—Ç
- —Ñ–æ–Ω
- —Ç–µ–∫—Å—Ç
- —Ç–µ–Ω–∏
- –≥—Ä–∞–Ω–∏—Ü—ã

### –¢—Ä–∏–≥–≥–µ—Ä—ã paint

- color
- background
- box-shadow
- outline

Paint **–Ω–µ –º–µ–Ω—è–µ—Ç –≥–µ–æ–º–µ—Ç—Ä–∏—é**, –Ω–æ –≤—Å—ë –µ—â—ë –¥–æ—Ä–æ–≥.

---

## Composite

### –ß—Ç–æ —ç—Ç–æ

Composite ‚Äî —ç—Ç–∞–ø —Å–±–æ—Ä–∫–∏ —Å–ª–æ—ë–≤:
- transform
- opacity
- GPU-—É—Å–∫–æ—Ä–µ–Ω–∏–µ

–°–∞–º—ã–π –¥–µ—à—ë–≤—ã–π —ç—Ç–∞–ø.

```css
.element {
  transform: translateX(20px);
  opacity: 0.8;
}
```

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç—Ç–∞–ø–æ–≤

| –ò–∑–º–µ–Ω–µ–Ω–∏–µ | Layout | Paint | Composite |
|---------|--------|-------|-----------|
| width | ‚úÖ | ‚úÖ | ‚ùå |
| margin | ‚úÖ | ‚úÖ | ‚ùå |
| color | ‚ùå | ‚úÖ | ‚ùå |
| box-shadow | ‚ùå | ‚úÖ | ‚ùå |
| transform | ‚ùå | ‚ùå | ‚úÖ |
| opacity | ‚ùå | ‚ùå | ‚úÖ |

---

## Layout Thrashing

### –ß—Ç–æ —ç—Ç–æ

Layout thrashing ‚Äî —á–∞—Å—Ç–æ–µ —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ:
- –∑–∞–ø–∏—Å–∏ layout-—Å–≤–æ–π—Å—Ç–≤
- —á—Ç–µ–Ω–∏—è layout-—Å–≤–æ–π—Å—Ç–≤

```js
for (let i = 0; i < 100; i++) {
  el.style.width = el.offsetWidth + 1 + "px";
}
```

–ö–∞–∂–¥–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è ‚Üí reflow.

### –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å

- –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å requestAnimationFrame
- –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä—ã

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- ‚ùå –Ω–µ –∞–Ω–∏–º–∏—Ä—É–π `top / left`
- ‚úÖ –∞–Ω–∏–º–∏—Ä—É–π `transform / opacity`
- ‚ùå –Ω–µ —á–∏—Ç–∞–π layout –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏
- ‚úÖ –∏—Å–ø–æ–ª—å–∑—É–π CSS-–∞–Ω–∏–º–∞—Ü–∏–∏ –∏ GPU

---

## –ö–∞–∫ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏

1. Layout ‚Äî –ø–µ—Ä–µ—Å—á—ë—Ç –≥–µ–æ–º–µ—Ç—Ä–∏–∏ (—Å–∞–º—ã–π –¥–æ—Ä–æ–≥–æ–π)
2. Paint ‚Äî –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –ø–∏–∫—Å–µ–ª–µ–π
3. Composite ‚Äî —Å–±–æ—Ä–∫–∞ —Å–ª–æ—ë–≤ (–¥–µ—à—ë–≤—ã–π)
4. transform / opacity –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç layout
5. Layout thrashing ‚Äî –∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω

---

## –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏

1. –ß—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç reflow?
2. –ß–µ–º repaint –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç reflow?
3. –ü–æ—á–µ–º—É transform –±—ã—Å—Ç—Ä–µ–µ?
4. –ß—Ç–æ —Ç–∞–∫–æ–µ layout thrashing?
5. –ö–∞–∫ –µ–≥–æ –∏–∑–±–µ–∂–∞—Ç—å?

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã

- Rendering pipeline
- requestAnimationFrame
- Performance
- CSS animations
